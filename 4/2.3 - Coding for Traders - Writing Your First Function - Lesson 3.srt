1
00:00:00,000 --> 00:00:00,760
Hey everyone,

2
00:00:01,000 --> 00:00:04,360
so today we're going to be going another step further with functions.

3
00:00:04,480 --> 00:00:05,700
We're going to be writing our own function,

4
00:00:06,200 --> 00:00:09,260
and we're just going to touch a little bit on the last video as well.

5
00:00:09,800 --> 00:00:13,460
So over here, the environment, the global environment,

6
00:00:13,640 --> 00:00:17,320
that's where our variables are stored, right? So when we have x equals 10,

7
00:00:18,290 --> 00:00:24,960
it's stored in here, right? And when we call x, what happens is R says, okay,

8
00:00:25,000 --> 00:00:28,320
what is x? So it goes into our environment, our global environment, and says,

9
00:00:28,420 --> 00:00:32,320
hmm, this is x, so that must equal 10. And so down in the console,

10
00:00:32,700 --> 00:00:37,450
we print the number 10. Now when we do something like getSymbols,

11
00:00:37,590 --> 00:00:41,540
so let's say we getSymbols QQQ,

12
00:00:45,190 --> 00:00:48,550
it's still in our global environment. So now when we call QQQ,

13
00:00:51,040 --> 00:00:52,060
this is the data.

14
00:00:57,160 --> 00:00:59,100
So if we take a look at getSymbols,

15
00:00:59,220 --> 00:01:04,100
you can see that there's actually multiple arguments, right? So remember,

16
00:01:04,180 --> 00:01:06,000
the question mark says, tell me a little bit about,

17
00:01:06,180 --> 00:01:09,770
tell me a little more about this function. So here we have our symbols,

18
00:01:10,630 --> 00:01:16,360
which we did QQQ. We can do an environment. Let's not worry about these.

19
00:01:17,340 --> 00:01:23,390
And then you can say auto-assign. So this is, see how when we say getSymbols,

20
00:01:25,130 --> 00:01:32,960
it automatically assigns it here, right? If we did, let's say, getSymbols SPY,

21
00:01:33,120 --> 00:01:37,020
it's automatically going to assign SPY in our global environment.

22
00:01:39,060 --> 00:01:40,280
But let's say we don't want that.

23
00:01:40,660 --> 00:01:49,640
Let's say we want to store it as X equals getSymbols SPY.

24
00:01:50,100 --> 00:01:55,650
Let's see what happens when we do that. What happens is X becomes SPY, right?

25
00:01:55,690 --> 00:01:59,430
But if we look at X, it's just the number, just the letter SPY.

26
00:02:00,200 --> 00:02:04,750
So what we want to do is we want to say auto-assign equals false.

27
00:02:05,390 --> 00:02:10,070
So what this is saying is don't assign it to our global environment without us telling

28
00:02:10,070 --> 00:02:12,910
you what to do. And we're saying create it as the variable X.

29
00:02:12,910 --> 00:02:19,210
So now when we run that, here X, we can go X, and now we get the data.

30
00:02:20,840 --> 00:02:25,700
And something else we can do is we can say when we want the date for.

31
00:02:26,020 --> 00:02:36,770
So from equals, let's say we want from 1995, 01-01. And then to equals today.

32
00:02:36,950 --> 00:02:41,470
So sys.date is today, right? And the way you do it is you put it,

33
00:02:41,790 --> 00:02:48,950
let's get down here, you put sys.date in brackets, right?

34
00:02:49,070 --> 00:02:51,130
And that is because it's a function. We're calling a function.

35
00:02:51,270 --> 00:02:56,280
If we were to do sum, if we were to say sum 10 and 20,

36
00:02:56,880 --> 00:03:01,880
we have to put the sum in brackets because it is a function.

37
00:03:02,660 --> 00:03:10,920
So here we're going to say sys.date. What is today? 2020-02-02.

38
00:03:12,870 --> 00:03:16,520
So now let's do this. And if we call head,

39
00:03:17,260 --> 00:03:20,440
head means so if we have a whole data frame, head means the top,

40
00:03:20,960 --> 00:03:25,900
tail means the bottom. So if we said head X, we have from 1995 now,

41
00:03:26,040 --> 00:03:30,960
S&P 500 data. And if we said tail X,

42
00:03:33,720 --> 00:03:38,420
we now have the bottom part, right? So this is today's data.

43
00:03:39,580 --> 00:03:40,760
Friday was the 31st.

44
00:03:42,520 --> 00:03:45,080
So here's the top of our data and here's the bottom of our data.

45
00:03:47,240 --> 00:03:49,440
A very cool feature as well is you can say, for example,

46
00:03:49,880 --> 00:04:01,840
get symbols and we start a vector SPY comma QQQ and IWM.

47
00:04:02,740 --> 00:04:06,820
And what happens now is we have IWM, QQQ and SPY.

48
00:04:06,940 --> 00:04:20,270
And let's say we want to get it from 2009-01-01, two equals 2010-01-01,

49
00:04:22,500 --> 00:04:26,960
right? Now we just have that data here. So view is another function that says,

50
00:04:27,220 --> 00:04:31,060
let's look at our data. So capital V, view, IWM.

51
00:04:33,230 --> 00:04:37,210
So now we have 2009 data all the way down to 2000, well,

52
00:04:37,570 --> 00:04:40,130
since the beginning of 2010, right? 01-01.

53
00:04:44,080 --> 00:04:50,000
As well, we can create our vector. So let's say stocks equals C, right?

54
00:04:50,160 --> 00:04:58,270
We're creating a vector SPY, QQQ, IWM. And now let's take a look at stocks.

55
00:04:59,880 --> 00:05:04,330
QQQ, IWM, SPY. So what we can do now is we can say get symbols,

56
00:05:07,480 --> 00:05:07,820
stocks,

57
00:05:10,280 --> 00:05:12,560
and now it pulls it in.

58
00:05:13,000 --> 00:05:19,140
So we don't need to state right here that we have to pull these three in.

59
00:05:19,260 --> 00:05:24,380
We can create a variable first, stocks. So that's where we're storing this,

60
00:05:24,980 --> 00:05:28,990
right? This right here is equivalent to stocks, right? What are we saying here?

61
00:05:28,990 --> 00:05:35,430
Stocks is equivalent to this. So get symbol stocks is saying get symbols this,

62
00:05:36,230 --> 00:05:38,210
right? It calls it. We can just highlight that.

63
00:05:39,620 --> 00:05:43,580
So that's what's happening over here. So this is a really, you know,

64
00:05:43,620 --> 00:05:47,960
get symbols is a great function to pull in data and to take a quick look at our

65
00:05:47,960 --> 00:05:52,340
stocks. So what we're going to do is we are going to create our own function.

66
00:05:53,590 --> 00:05:57,130
And what this function is going to do is it's going to,

67
00:05:57,290 --> 00:05:58,990
we're going to type in a ticker name.

68
00:05:59,340 --> 00:06:04,120
It's going to add on to the get symbols function where all you have to do is type

69
00:06:04,120 --> 00:06:04,740
in a ticker name.

70
00:06:05,740 --> 00:06:14,140
It's going to graph the stock data and moving averages depending on the parameters

71
00:06:14,140 --> 00:06:16,680
you want. And when I mean parameters, I mean like,

72
00:06:17,180 --> 00:06:20,780
do you want the 10-day simple moving average or the 50-day simple moving average,

73
00:06:21,180 --> 00:06:24,480
whatever you're looking for. So let's go ahead and start this.

74
00:06:24,860 --> 00:06:28,660
So the way you start a function is we're going to call it a name, right?

75
00:06:28,660 --> 00:06:30,040
So get symbols is a function name.

76
00:06:30,120 --> 00:06:35,060
We're going to call this one plot underscore tickers. It could be,

77
00:06:35,180 --> 00:06:38,900
and this could be anything. This could be predicting alpha.

78
00:06:39,080 --> 00:06:40,100
This could be whatever you want,

79
00:06:40,340 --> 00:06:42,300
but we're going to call it plot underscore tickers.

80
00:06:43,420 --> 00:06:47,700
And we're going to say this is equal to, it's a function, okay?

81
00:06:48,240 --> 00:06:50,140
So inside the function, we're going to put our parameters.

82
00:06:51,120 --> 00:06:54,320
So our parameters are going to be, right? Just like remember, get symbols,

83
00:06:54,420 --> 00:06:56,800
we have symbols, right? We have all these.

84
00:06:56,840 --> 00:07:01,340
These are the parameters inside the function. So let's say for plot tickers,

85
00:07:01,400 --> 00:07:04,240
we want to have the ticker.

86
00:07:04,900 --> 00:07:07,000
So we're just going to look at one ticker when we do ours.

87
00:07:07,850 --> 00:07:12,860
We're going to do ticker. We're going to have from date and to date.

88
00:07:13,790 --> 00:07:21,310
And then we're also going to have moving average one parameter and moving average

89
00:07:21,310 --> 00:07:24,190
two parameter. So this might be like the 50-day, the 100-day.

90
00:07:27,100 --> 00:07:31,380
And then we do these curly braces to start the function.

91
00:07:31,380 --> 00:07:35,540
And now whatever we write in here is what's going to happen.

92
00:07:37,770 --> 00:07:43,870
So first thing we're going to do is we're going to say our stock, okay,

93
00:07:44,450 --> 00:07:53,420
is equal to get symbols, okay, ticker. So this, whatever we put in here, right?

94
00:07:53,480 --> 00:07:58,600
Let's say when we put spy as symbols, get symbols pulls it, right?

95
00:07:58,860 --> 00:08:02,880
So we're saying whatever we're going to put in here, plug it in here.

96
00:08:02,880 --> 00:08:07,960
So if we say, for example, we put spy in here, it's going to plug it in there.

97
00:08:08,660 --> 00:08:12,170
And we're going to have from equals from, right?

98
00:08:12,370 --> 00:08:16,690
From is going to get plugged into there. To equals to.

99
00:08:17,800 --> 00:08:21,640
And auto assign equals false, right?

100
00:08:23,520 --> 00:08:27,060
We are saying don't just put it into our global environment.

101
00:08:27,320 --> 00:08:29,300
We want to save it as our stock.

102
00:08:30,640 --> 00:08:39,260
What we're going to do next is we are going to calculate what we're going to do

103
00:08:39,260 --> 00:08:44,790
next is we are going to create our first simple moving average and add it into our

104
00:08:44,790 --> 00:08:46,850
data frame. So we're going to take our stock.

105
00:08:49,100 --> 00:08:53,860
This is select, right? But if there's nothing to select,

106
00:08:54,220 --> 00:08:57,660
so we're going to say select SMA slow.

107
00:08:58,100 --> 00:08:59,580
So this is going to be our slow moving average.

108
00:08:59,680 --> 00:09:04,790
So maybe the 200 day and the fast one is going to be like maybe the 20 or 30,

109
00:09:04,990 --> 00:09:06,030
whatever you guys decide to choose.

110
00:09:08,500 --> 00:09:12,480
What we're saying is go to our stock, select SMA slow. Now,

111
00:09:12,660 --> 00:09:14,140
what's the problem here? So remember,

112
00:09:14,240 --> 00:09:21,940
our stock is going to be the same as if we said get symbols SPY, right?

113
00:09:22,020 --> 00:09:26,390
So let's take a look at that. And do you see something called SMA slow?

114
00:09:26,650 --> 00:09:31,330
I see SPY open, high, low, close, volume adjusted. So there is none.

115
00:09:34,260 --> 00:09:38,560
So there is none. So what this is saying is create this, right?

116
00:09:38,740 --> 00:09:45,300
Because SMA slow is not an actual variable right now. It's not a column.

117
00:09:45,580 --> 00:09:51,130
We're going to create this column. And this is going to be equal to SMA, right?

118
00:09:51,190 --> 00:09:54,990
So in the quant mod package, which is also the TTR,

119
00:09:56,580 --> 00:10:02,090
there is already SMA function. So SMA, we're going to say the close,

120
00:10:04,820 --> 00:10:09,560
right? So close is another function. So if we did CL SPY,

121
00:10:10,480 --> 00:10:12,340
it would just pull the close.

122
00:10:14,940 --> 00:10:19,320
So we're going to go close our stock, right?

123
00:10:19,320 --> 00:10:22,740
Because our stock is now saved as it was auto assigned to it.

124
00:10:22,860 --> 00:10:24,260
So this is not SPY anymore.

125
00:10:26,400 --> 00:10:28,860
So this is equivalent to SPY.

126
00:10:30,950 --> 00:10:33,690
So close, basically, whatever our ticker is.

127
00:10:33,710 --> 00:10:37,580
Let's say we're going to play around with SPY. And N,

128
00:10:37,940 --> 00:10:41,500
so let's take a look at what the SMA function does.

129
00:10:44,650 --> 00:10:49,870
So it has N. So N is the length, right? You want the 200 day, the 10 day,

130
00:10:49,930 --> 00:10:55,250
the 50 day. And by default, it's 10. So we're going to say N is equal to M1.

131
00:10:56,530 --> 00:10:58,890
So right here, whatever we put in here is going to get plugged into here.

132
00:11:01,180 --> 00:11:08,990
Okay. Now we're going to say our stock SMA fast, right?

133
00:11:09,110 --> 00:11:16,260
We're going to create this new column fast is equal to SMA CL.

134
00:11:17,020 --> 00:11:26,040
Our stock N equals M2, right?

135
00:11:26,100 --> 00:11:29,140
So now we're going to create this new variable with our fast SMA.

136
00:11:29,140 --> 00:11:31,420
And we're going to be plugging in whatever that is here.

137
00:11:32,200 --> 00:11:36,940
So now we actually have all the data we need. We have our closing price.

138
00:11:37,120 --> 00:11:41,800
We have our SMA slow. And we have our SMA fast. So now we need to plot this.

139
00:11:42,380 --> 00:11:45,770
So now what we're going to do is we're going to only select the three variables

140
00:11:45,770 --> 00:11:49,410
we need, which is the close, the SMA slow, and the SMA fast.

141
00:11:49,490 --> 00:11:59,440
So we're going to say new.dataframe is going to be equal to our stock. Okay.

142
00:11:59,520 --> 00:12:01,880
And now we're going to do something you guys haven't seen before,

143
00:12:01,980 --> 00:12:05,300
and that's square brackets. So when we look into a data frame,

144
00:12:05,470 --> 00:12:15,030
we have two dimensions, columns and rows. So if we were to say SPY, right,

145
00:12:15,070 --> 00:12:22,080
square brackets, this is how we access the data frame. We want to see row one.

146
00:12:23,430 --> 00:12:23,870
Column,

147
00:12:26,880 --> 00:12:31,540
so we should see SPY open. We should see this number right here.

148
00:12:33,870 --> 00:12:37,610
So let's do it. And there it is, right?

149
00:12:37,670 --> 00:12:40,570
We're taking the first column and the first row. So the first,

150
00:12:41,050 --> 00:12:46,270
now let's go to the second row, first column. So we should now see 141.23.

151
00:12:46,770 --> 00:12:56,850
So let's run that, 141.23. Now let's go find the third row, third column.

152
00:12:57,980 --> 00:13:00,400
All right, so now we're over here. We're on the second row, third column.

153
00:13:02,180 --> 00:13:08,680
So what we're going to do now is we're going to say if we want all the columns,

154
00:13:08,900 --> 00:13:14,230
we leave it empty. So we'd say this, SPY, row two, comma,

155
00:13:14,790 --> 00:13:18,690
and we leave this empty. This means give me all the columns.

156
00:13:20,120 --> 00:13:22,680
And if we did the other way around, we said give me all the rows,

157
00:13:22,920 --> 00:13:27,040
only on column two. We're going to want to see only column two, all the rows.

158
00:13:27,880 --> 00:13:32,760
And there it is. So what we're going to do is we're going to say our stock,

159
00:13:33,380 --> 00:13:37,780
give me all the rows, but give me only the columns.

160
00:13:37,780 --> 00:13:45,040
We're going to create a vector here that are called SMA fast,

161
00:13:49,890 --> 00:13:52,340
SMA slow.

162
00:13:54,980 --> 00:13:57,680
And then we're going to say new.df,

163
00:14:00,080 --> 00:14:02,900
close is equal to CL,

164
00:14:05,040 --> 00:14:10,360
our stock. Okay, so basically we have our whole data frame now.

165
00:14:11,050 --> 00:14:19,300
Once we do that, we are going to plot new.df.

166
00:14:21,050 --> 00:14:24,170
And so it's going to plot every single point on our data frame.

167
00:14:28,710 --> 00:14:33,850
Once we have that, we just press enter. This is our new function now.

168
00:14:33,930 --> 00:14:47,180
So we go plot, plot tickers, SPY, from equals 2010-01-01,

169
00:14:48,000 --> 00:14:55,850
two equals 2000, and let's go 20-01-01. And let's see what happens.

170
00:14:57,080 --> 00:15:01,100
We get an error. M1 is missing. We have to plot those in there.

171
00:15:01,160 --> 00:15:05,480
So let's go with 50. Let's do our 200, 50.

172
00:15:10,740 --> 00:15:11,880
And there we have it.

173
00:15:14,000 --> 00:15:21,970
Here we have just plotted our 200-day moving average with our 50-day simple moving

174
00:15:21,970 --> 00:15:28,030
average and with S&P 500 over there. If you guys want to change the title,

175
00:15:28,270 --> 00:15:33,300
we can go back to the plot. We can add main equals ticker.

176
00:15:34,260 --> 00:15:37,340
So whatever the ticker's name is going to add it over there.

177
00:15:38,460 --> 00:15:39,700
And then we're going to say,

178
00:15:42,940 --> 00:15:45,060
and then we're going to run that. So we're going to hit enter again,

179
00:15:48,260 --> 00:15:53,680
and we're going to do the same thing. And now we ran this exact same function,

180
00:15:54,000 --> 00:15:56,800
but now we have SPY. And let's do it on another one.

181
00:16:01,050 --> 00:16:07,280
So let's go plot tickers. Let's go QQQ.

182
00:16:10,020 --> 00:16:19,080
And from equals 2010-01-01. And to equals, let's say, sys.date.

183
00:16:19,340 --> 00:16:26,400
So that's today. And we're going to do a, let's go 10-day slow and 5-day fast.

184
00:16:26,500 --> 00:16:30,690
So really fast crossovers. And look at that. You can barely even see.

185
00:16:31,760 --> 00:16:34,360
It's basically trading with the chart. So maybe we'll go a little longer here.

186
00:16:35,730 --> 00:16:42,330
Let's go with a 200 again. We'll go with the 200, and we'll go with a 20.

187
00:16:44,430 --> 00:16:48,860
And there we have it. All right, guys, so that'll do it for us today.

188
00:16:49,440 --> 00:16:51,020
I hope you guys are learning a ton through this.

189
00:16:51,080 --> 00:16:54,100
I'm really excited about the community growing, and I'll talk to you guys soon.
